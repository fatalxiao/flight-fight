# 闪电战机 - 竖版射击游戏

一个使用HTML5 Canvas和JavaScript开发的太空射击游戏，支持键盘和PS5手柄控制。采用函数式编程和模块化设计。

## 🎮 游戏特色

- **双控制方式**：支持键盘和PS5手柄操作
- **10个关卡**：从简单到困难的渐进式挑战
- **多种敌人**：10种不同类型的敌人，各有特色
- **小行星系统**：可击毁的陨石，不同尺寸和分数
- **升级系统**：火力等级提升，增强攻击力
- **特效丰富**：爆炸效果、激光束、星空背景
- **响应式设计**：适配不同屏幕尺寸
- **模块化架构**：函数式编程，易于维护和扩展

## 🕹️ 控制方式

### 键盘控制
- **移动**：方向键 或 WASD
- **普通射击**：自动射击
- **特殊射击**：空格键（2秒冷却）

### PS5手柄控制
- **移动**：左摇杆
- **备用移动**：十字键
- **普通射击**：自动射击
- **特殊射击**：右扳机(R2)（2秒冷却）

## 🎯 游戏玩法

1. **目标**：击落所有敌人，完成10个关卡
2. **生命值**：玩家有5条生命，被敌人击中会减少
3. **得分系统**：击落不同敌人获得不同分数
4. **火力升级**：收集道具提升火力等级
5. **特殊技能**：使用大招发射加强型子弹

## 🚀 敌人类型

| 敌人类型 | 特点 | 分数 |
|---------|------|------|
| 战斗机 | 基础敌人，平衡型 | 10分 |
| 轰炸机 | 血量较高，速度慢 | 15分 |
| 侦察机 | 速度快，血量低 | 8分 |
| 拦截机 | 平衡型，中等难度 | 12分 |
| 炮舰 | 重型敌人，高血量 | 20分 |
| 驱逐舰 | 强力敌人 | 30分 |
| 航母 | 超重型敌人 | 50分 |
| 战列舰 | 超强敌人 | 100分 |
| 无畏舰 | 终极敌人 | 150分 |
| 泰坦 | Boss级敌人 | 250分 |

## 🌟 小行星系统

游戏中的小行星是可以被击毁的障碍物，击毁后可以获得分数：

| 小行星类型 | 尺寸 | 血量 | 分数 | 伤害 |
|-----------|------|------|------|------|
| 小型 | 15px | 20 | 50分 | 10 |
| 中型 | 25px | 35 | 100分 | 15 |
| 大型 | 35px | 50 | 200分 | 20 |

**特点**：
- 随机生成，直线或斜向移动
- 旋转动画效果
- 显示血条
- 碰撞玩家会造成伤害
- 被子弹击中会减少血量

## 🏗️ 技术架构

### 模块化设计
```
flight-fight/
├── game.js          # 主游戏逻辑和状态管理
├── enemy.js         # 敌人系统和AI
├── collision.js     # 碰撞检测和特效
├── render.js        # 渲染系统和UI
├── index.html       # 游戏主页面
├── style.css        # 样式文件
└── README.md        # 说明文档
```

### 函数式编程
- ✅ **移除class结构**：使用纯函数和状态管理
- ✅ **模块化分离**：按功能职责分离代码
- ✅ **状态集中管理**：统一的gameState对象
- ✅ **函数组合**：通过函数调用组合功能

## 🔧 技术特性

### 新增功能
- ✅ **PS5手柄支持**：完整的Gamepad API集成
- ✅ **手柄死区处理**：避免摇杆漂移问题
- ✅ **多控制方案**：键盘+手柄双重支持
- ✅ **游戏通关界面**：第10关完成后显示通关庆祝
- ✅ **模块化重构**：函数式编程，易于维护

### 修复问题
- ✅ **普通子弹伤害修复**：添加damage属性，子弹可以正常击毁敌人
- ✅ **大招还原修复**：还原为加强型子弹而不是水平激光
- ✅ **第11关卡死修复**：添加了第11关数据，防止游戏崩溃
- ✅ **碰撞检测优化**：完善的错误处理机制
- ✅ **代码重构**：从class改为函数式编程

## 🎨 视觉效果

- **星空背景**：动态移动的星星效果
- **激光束**：发光的子弹和激光
- **爆炸效果**：多层次的爆炸动画
- **血条显示**：敌人和玩家的血量可视化
- **UI设计**：现代化的界面设计

## 🎯 快速开始

1. **下载游戏**：克隆或下载项目文件
2. **启动服务器**：运行 `python3 -m http.server 8000`
3. **打开游戏**：在浏览器中访问 `http://localhost:8000`
4. **开始游戏**：点击"开始游戏"按钮

## 🧪 测试功能

访问 `test-modules.html` 页面可以：
- 查看模块化结构
- 验证修复状态
- 测试游戏功能
- 了解重构成果

## 📱 浏览器兼容性

- Chrome 67+
- Firefox 60+
- Safari 11+
- Edge 79+

## 🎯 游戏目标

完成所有10个关卡，获得最高分数！每个关卡都有不同的敌人组合和难度设置，挑战你的射击技巧和反应能力。

## 🔄 更新日志

### v3.1.0 (最新) - 小行星系统
- 🌟 **新增小行星系统**：可击毁的陨石，不同尺寸和分数
- 🎯 **敌人生成优化**：敌机现在在屏幕中央生成，不再在左侧边缘
- 🎨 **背景优化**：移除干扰性的半透明圆形和水平移动长方形
- ⚡ **碰撞检测**：小行星与子弹、玩家的完整碰撞系统
- 🎮 **游戏平衡**：增加新的得分来源和挑战元素

### v3.0.0 - 模块化重构
- 🏗️ **完全重构**：从class改为函数式编程
- 📁 **模块化设计**：拆分为4个独立模块
- 🔧 **修复bug**：普通子弹伤害、大招效果
- 🎮 **优化体验**：改进控制响应
- 📊 **代码质量**：提高可维护性和可读性

### v2.0.0
- ✨ 添加PS5手柄支持
- 🐛 修复第11关卡死问题
- 🎉 添加游戏通关界面
- 🎮 改进控制体验
- 🎨 优化视觉效果

### v1.0.0
- 🎮 基础游戏功能
- ⌨️ 键盘控制
- 🎯 10个关卡设计
- 💥 爆炸特效系统

## 🛠️ 开发说明

### 模块职责
- **game.js**：主游戏逻辑、状态管理、事件处理
- **enemy.js**：敌人系统、敌人生成、敌人AI
- **collision.js**：碰撞检测、特效系统、游戏状态检查
- **render.js**：渲染系统、UI更新、视觉效果

### 状态管理
使用全局`gameState`对象统一管理游戏状态，包括：
- 游戏数据（分数、关卡、生命值等）
- 游戏对象（玩家、敌人、子弹等）
- 输入状态（键盘、手柄）
- 时间控制（射击冷却等）

---

**享受游戏！** 🚀✨ 